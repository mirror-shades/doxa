module g from "graphics"

const rl is g.raylib
const dg is g.doxa

entry function main() {
    
    const WIDTH is 800
    const HEIGHT is 600
    const FPS is 60
    const NAME is "Working Graphics Demo"
    
    // doxa has a simplified API for initializing graphics
    // Initialize graphics (defers CloseWindow automatically)
    dg.Init(WIDTH, HEIGHT, FPS, NAME)
    
    var frame_count :: int
    
    while dg.Running() {
        // Begin drawing (defers EndDrawing automatically)
        dg.Draw()
        drawBackground(frame_count)
        drawCircle(frame_count)
        frame_count += 1
    }    
}

function drawBackground(frame_count :: int) {
    if (frame_count % 200 < 100) then {
        rl.ClearBackground(rl.GRAY)
    } else {
        rl.ClearBackground(rl.LIGHTGRAY)
    }
}

function drawCircle(frame_count :: int) {
    const circle_x is (frame_count * 4) % 800 
    const circle_y is (frame_count * 3) % 600
    rl.DrawCircle(circle_x, circle_y, 30, rl.ORANGE)
}
